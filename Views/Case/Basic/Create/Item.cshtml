@model CanLove_Backend.Application.ViewModels.Case.Basic.CaseFormVM

@{
    ViewData["Title"] = "新增個案基本資料";
    // 自訂麵包屑：首頁 > 個案管理 > 新增個案 > 個案基本資料
    ViewData["Breadcrumbs"] = new List<(string Text, string Url)>
    {
        ("個案管理", Url.Action("Query", "CaseBasicQuery") ?? string.Empty),
        ("新增個案", Url.Action("Create", "CaseBasicCreateEdit") ?? string.Empty),
        ("個案基本資料", string.Empty)
    };
}

<div class="w-full px-4 sm:px-6 lg:px-8">
    <div class="max-w-[1400px] mx-auto">
        @{ ViewBag.CurrentPage = "Create"; ViewBag.CurrentTab = "CaseBasic"; }
        <partial name="~/Views/Shared/Partials/_CaseFormTabs.cshtml" />
        <div class="card bg-white dark:bg-slate-900 shadow-card-lg border rounded-xl border-[#9CCC65] dark:border-slate-700 mt-3">
            <div class="px-6 py-6">
                <form asp-controller="CaseBasicCreateEdit" asp-action="Create" method="post" enctype="multipart/form-data" class="prevent-double-submit">
                    <partial name="~/Views/Shared/Partials/_ValidationSummary.cshtml" model="ViewData.ModelState" />
                    <partial name="~/Views/Case/Basic/Partials/_CaseBasicFormFields.cshtml" model="Model" />
                    <partial name="~/Views/Shared/Partials/_CaseFormActions.cshtml" model="Model" />
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/case-form-common.js"></script>
    <script>
        // 初始化城市/地區聯動
        const districtsByCity = @Html.Raw(Json.Serialize(ViewBag.DistrictsByCity));
        if (districtsByCity) {
            initCityDistrict(districtsByCity);
        }

        // 初始化新增學校功能
        initSchoolAdd();

        // 初始化照片預覽功能（新增模式，無現有照片）
        initPhotoPreview();
    </script>
}


