@model CanLove_Backend.Domain.Case.ViewModels.Basic.CaseFormVM

@{
    ViewData["Title"] = "查看個案基本資料";
    ViewData["Breadcrumbs"] = new List<(string Text, string Url)>
    {
        ("個案管理", Url.Action("Query", "CaseBasicQuery") ?? string.Empty),
        ("查看個案", Url.Action("ViewItem", "CaseBasicQuery", new { id = Model.Case.CaseId }) ?? string.Empty),
        ("個案基本資料", string.Empty)
    };
}

<div class="w-full px-4 sm:px-6 lg:px-8">
    <div class="max-w-[1400px] mx-auto">
        @{
            ViewBag.CardTitle = "個案詳細資料";
            ViewBag.ShowCloseButton = true;
            ViewBag.CloseButtonUrl = Url.Action("Query", "CaseBasicQuery");
            ViewBag.ActionButtons = new List<(string Text, string Action, string Controller, string Class, string Icon, bool IsForm, string FormAction)>
            {
                ("編輯", "EditItem", "CaseBasicCreateEdit", "btn", "bi bi-pencil", false, "")
            };
        }
        <partial name="~/Views/Case/Basic/Partials/_CaseDetailCard.cshtml" model="Model" />
    </div>
</div>

@section Scripts {
    <script src="~/js/case-form-common.js"></script>
    <script>
        // 載入地區資料（只讀模式，僅用於顯示）
        const districtsByCity = @Html.Raw(Json.Serialize(ViewBag.DistrictsByCity));
        const currentDistrictId = document.getElementById('districtSelect')?.value || document.getElementById('districtSelect')?.getAttribute('data-current-district-id');
        if (districtsByCity) {
            initCityDistrict(districtsByCity, currentDistrictId);
        }

        // 載入已存在的照片
        const photoUrl = @Html.Raw(Json.Serialize(ViewBag.PhotoUrl));
        if (photoUrl) {
            initPhotoPreview(photoUrl);
        }
    </script>
}

